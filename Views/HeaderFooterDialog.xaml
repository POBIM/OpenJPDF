<Window x:Class="OpenJPDF.Views.HeaderFooterDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:models="clr-namespace:OpenJPDF.Models"
        mc:Ignorable="d"
        Title="Header &amp; Footer Settings" 
        Height="650" Width="700"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        Background="#F5F5F5">
    
    <Window.Resources>
        <Style x:Key="SectionHeader" TargetType="TextBlock">
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Margin" Value="0,0,0,8"/>
        </Style>
        <Style x:Key="FieldLabel" TargetType="TextBlock">
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Foreground" Value="#666666"/>
            <Setter Property="Margin" Value="0,0,0,4"/>
        </Style>
    </Window.Resources>
    
    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Title -->
        <StackPanel Grid.Row="0" Margin="0,0,0,16">
            <TextBlock Text="Header &amp; Footer Settings" FontSize="18" FontWeight="SemiBold"/>
            <TextBlock Text="Add headers and footers to your PDF document. Use placeholders: {page}, {total}, {date}, {filename}" 
                       Foreground="#666666" FontSize="11" Margin="0,4,0,0" TextWrapping="Wrap"/>
        </StackPanel>
        
        <!-- Content -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <!-- Header Section -->
                <Border Background="White" CornerRadius="8" Padding="16" Margin="0,0,0,16">
                    <StackPanel>
                        <CheckBox x:Name="HeaderEnabledCheck" Content="Enable Header" FontWeight="SemiBold" Margin="0,0,0,12"/>
                        
                        <Grid IsEnabled="{Binding IsChecked, ElementName=HeaderEnabledCheck}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- Header Left -->
                            <StackPanel Grid.Column="0" Margin="0,0,8,0">
                                <TextBlock Text="Left" Style="{StaticResource FieldLabel}"/>
                                <RadioButton x:Name="HeaderLeftText" Content="Text" IsChecked="True" GroupName="HeaderLeftType" Margin="0,0,0,4"/>
                                <TextBox x:Name="HeaderLeftTextBox" Margin="0,0,0,8"/>
                                <RadioButton x:Name="HeaderLeftImage" Content="Image" GroupName="HeaderLeftType" Margin="0,0,0,4"/>
                                <Button x:Name="HeaderLeftImageBtn" Content="Select Image..." Click="SelectHeaderLeftImage_Click" Margin="0,0,0,4"/>
                                <TextBlock x:Name="HeaderLeftImagePath" Text="" FontSize="10" TextTrimming="CharacterEllipsis" Foreground="#888"/>
                            </StackPanel>
                            
                            <!-- Header Center -->
                            <StackPanel Grid.Column="1" Margin="8,0,8,0">
                                <TextBlock Text="Center" Style="{StaticResource FieldLabel}"/>
                                <RadioButton x:Name="HeaderCenterText" Content="Text" IsChecked="True" GroupName="HeaderCenterType" Margin="0,0,0,4"/>
                                <TextBox x:Name="HeaderCenterTextBox" Margin="0,0,0,8"/>
                                <RadioButton x:Name="HeaderCenterImage" Content="Image" GroupName="HeaderCenterType" Margin="0,0,0,4"/>
                                <Button x:Name="HeaderCenterImageBtn" Content="Select Image..." Click="SelectHeaderCenterImage_Click" Margin="0,0,0,4"/>
                                <TextBlock x:Name="HeaderCenterImagePath" Text="" FontSize="10" TextTrimming="CharacterEllipsis" Foreground="#888"/>
                            </StackPanel>
                            
                            <!-- Header Right -->
                            <StackPanel Grid.Column="2" Margin="8,0,0,0">
                                <TextBlock Text="Right" Style="{StaticResource FieldLabel}"/>
                                <RadioButton x:Name="HeaderRightText" Content="Text" IsChecked="True" GroupName="HeaderRightType" Margin="0,0,0,4"/>
                                <TextBox x:Name="HeaderRightTextBox" Margin="0,0,0,8"/>
                                <RadioButton x:Name="HeaderRightImage" Content="Image" GroupName="HeaderRightType" Margin="0,0,0,4"/>
                                <Button x:Name="HeaderRightImageBtn" Content="Select Image..." Click="SelectHeaderRightImage_Click" Margin="0,0,0,4"/>
                                <TextBlock x:Name="HeaderRightImagePath" Text="" FontSize="10" TextTrimming="CharacterEllipsis" Foreground="#888"/>
                            </StackPanel>
                        </Grid>
                        
                        <!-- Header Font Settings -->
                        <StackPanel Orientation="Horizontal" Margin="0,12,0,0" IsEnabled="{Binding IsChecked, ElementName=HeaderEnabledCheck}">
                            <TextBlock Text="Font:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                            <ComboBox x:Name="HeaderFontFamily" Width="120" SelectedIndex="0" Margin="0,0,8,0">
                                <ComboBoxItem Content="Arial"/>
                                <ComboBoxItem Content="Times New Roman"/>
                                <ComboBoxItem Content="Tahoma"/>
                                <ComboBoxItem Content="TH Sarabun New"/>
                            </ComboBox>
                            <TextBlock Text="Size:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                            <ComboBox x:Name="HeaderFontSize" Width="60" SelectedIndex="2">
                                <ComboBoxItem Content="8"/>
                                <ComboBoxItem Content="9"/>
                                <ComboBoxItem Content="10"/>
                                <ComboBoxItem Content="11"/>
                                <ComboBoxItem Content="12"/>
                                <ComboBoxItem Content="14"/>
                            </ComboBox>
                            <CheckBox x:Name="HeaderBold" Content="Bold" Margin="16,0,8,0" VerticalAlignment="Center"/>
                            <CheckBox x:Name="HeaderItalic" Content="Italic" VerticalAlignment="Center"/>
                        </StackPanel>
                    </StackPanel>
                </Border>
                
                <!-- Footer Section -->
                <Border Background="White" CornerRadius="8" Padding="16" Margin="0,0,0,16">
                    <StackPanel>
                        <CheckBox x:Name="FooterEnabledCheck" Content="Enable Footer" FontWeight="SemiBold" Margin="0,0,0,12" IsChecked="True"/>
                        
                        <Grid IsEnabled="{Binding IsChecked, ElementName=FooterEnabledCheck}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- Footer Left -->
                            <StackPanel Grid.Column="0" Margin="0,0,8,0">
                                <TextBlock Text="Left" Style="{StaticResource FieldLabel}"/>
                                <RadioButton x:Name="FooterLeftText" Content="Text" IsChecked="True" GroupName="FooterLeftType" Margin="0,0,0,4"/>
                                <TextBox x:Name="FooterLeftTextBox" Margin="0,0,0,8"/>
                                <RadioButton x:Name="FooterLeftImage" Content="Image" GroupName="FooterLeftType" Margin="0,0,0,4"/>
                                <Button x:Name="FooterLeftImageBtn" Content="Select Image..." Click="SelectFooterLeftImage_Click" Margin="0,0,0,4"/>
                                <TextBlock x:Name="FooterLeftImagePath" Text="" FontSize="10" TextTrimming="CharacterEllipsis" Foreground="#888"/>
                            </StackPanel>
                            
                            <!-- Footer Center -->
                            <StackPanel Grid.Column="1" Margin="8,0,8,0">
                                <TextBlock Text="Center" Style="{StaticResource FieldLabel}"/>
                                <RadioButton x:Name="FooterCenterText" Content="Text" IsChecked="True" GroupName="FooterCenterType" Margin="0,0,0,4"/>
                                <TextBox x:Name="FooterCenterTextBox" Text="Page {page} of {total}" Margin="0,0,0,8"/>
                                <RadioButton x:Name="FooterCenterImage" Content="Image" GroupName="FooterCenterType" Margin="0,0,0,4"/>
                                <Button x:Name="FooterCenterImageBtn" Content="Select Image..." Click="SelectFooterCenterImage_Click" Margin="0,0,0,4"/>
                                <TextBlock x:Name="FooterCenterImagePath" Text="" FontSize="10" TextTrimming="CharacterEllipsis" Foreground="#888"/>
                            </StackPanel>
                            
                            <!-- Footer Right -->
                            <StackPanel Grid.Column="2" Margin="8,0,0,0">
                                <TextBlock Text="Right" Style="{StaticResource FieldLabel}"/>
                                <RadioButton x:Name="FooterRightText" Content="Text" IsChecked="True" GroupName="FooterRightType" Margin="0,0,0,4"/>
                                <TextBox x:Name="FooterRightTextBox" Margin="0,0,0,8"/>
                                <RadioButton x:Name="FooterRightImage" Content="Image" GroupName="FooterRightType" Margin="0,0,0,4"/>
                                <Button x:Name="FooterRightImageBtn" Content="Select Image..." Click="SelectFooterRightImage_Click" Margin="0,0,0,4"/>
                                <TextBlock x:Name="FooterRightImagePath" Text="" FontSize="10" TextTrimming="CharacterEllipsis" Foreground="#888"/>
                            </StackPanel>
                        </Grid>
                        
                        <!-- Footer Font Settings -->
                        <StackPanel Orientation="Horizontal" Margin="0,12,0,0" IsEnabled="{Binding IsChecked, ElementName=FooterEnabledCheck}">
                            <TextBlock Text="Font:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                            <ComboBox x:Name="FooterFontFamily" Width="120" SelectedIndex="0" Margin="0,0,8,0">
                                <ComboBoxItem Content="Arial"/>
                                <ComboBoxItem Content="Times New Roman"/>
                                <ComboBoxItem Content="Tahoma"/>
                                <ComboBoxItem Content="TH Sarabun New"/>
                            </ComboBox>
                            <TextBlock Text="Size:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                            <ComboBox x:Name="FooterFontSize" Width="60" SelectedIndex="2">
                                <ComboBoxItem Content="8"/>
                                <ComboBoxItem Content="9"/>
                                <ComboBoxItem Content="10"/>
                                <ComboBoxItem Content="11"/>
                                <ComboBoxItem Content="12"/>
                                <ComboBoxItem Content="14"/>
                            </ComboBox>
                            <CheckBox x:Name="FooterBold" Content="Bold" Margin="16,0,8,0" VerticalAlignment="Center"/>
                            <CheckBox x:Name="FooterItalic" Content="Italic" VerticalAlignment="Center"/>
                        </StackPanel>
                    </StackPanel>
                </Border>
                
                <!-- Page Range Section -->
                <Border Background="White" CornerRadius="8" Padding="16" Margin="0,0,0,16">
                    <StackPanel>
                        <TextBlock Text="Page Range" Style="{StaticResource SectionHeader}"/>
                        <RadioButton x:Name="ApplyAllPages" Content="Apply to all pages" IsChecked="True" GroupName="PageRange" Margin="0,0,0,8"/>
                        <StackPanel Orientation="Horizontal">
                            <RadioButton x:Name="ApplyPageRange" Content="Apply to pages:" GroupName="PageRange" VerticalAlignment="Center"/>
                            <TextBox x:Name="StartPageBox" Width="50" Text="1" Margin="8,0,4,0" IsEnabled="{Binding IsChecked, ElementName=ApplyPageRange}"/>
                            <TextBlock Text="to" VerticalAlignment="Center"/>
                            <TextBox x:Name="EndPageBox" Width="50" Text="1" Margin="4,0,0,0" IsEnabled="{Binding IsChecked, ElementName=ApplyPageRange}"/>
                        </StackPanel>
                        <CheckBox x:Name="SkipFirstPage" Content="Skip first page (cover page)" Margin="0,12,0,0"/>
                    </StackPanel>
                </Border>
                
                <!-- Custom Text Boxes Section -->
                <Border Background="White" CornerRadius="8" Padding="16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                            <TextBlock Text="Custom Text Boxes" Style="{StaticResource SectionHeader}" VerticalAlignment="Center" Margin="0,0,16,0"/>
                            <Button x:Name="AddTextBoxBtn" Content="+ Add Text Box" Click="AddTextBox_Click" 
                                    Padding="12,4" Background="#4CAF50" Foreground="White" FontWeight="SemiBold"/>
                        </StackPanel>
                        <TextBlock Text="Add custom text boxes for signatures, labels, or any text at specific positions." 
                                   Foreground="#666666" FontSize="11" Margin="0,0,0,12" TextWrapping="Wrap"/>
                        
                        <!-- Custom Text Boxes List -->
                        <ItemsControl x:Name="CustomTextBoxesList">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="#F8F8F8" CornerRadius="4" Padding="12" Margin="0,0,0,12">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            
                                            <!-- Left: Settings -->
                                            <StackPanel Grid.Column="0" Margin="0,0,16,0" Width="220">
                                                <!-- Label -->
                                                <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                                                    <TextBlock Text="Label:" Width="55" VerticalAlignment="Center"/>
                                                    <TextBox Text="{Binding Label, UpdateSourceTrigger=PropertyChanged}" Width="150"/>
                                                </StackPanel>
                                                
                                                <!-- Position -->
                                                <TextBlock Text="Position (points):" FontWeight="SemiBold" Margin="0,4,0,4" FontSize="11"/>
                                                <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                                                    <TextBlock Text="X:" Width="25" VerticalAlignment="Center"/>
                                                    <TextBox Text="{Binding OffsetX, UpdateSourceTrigger=PropertyChanged}" Width="55" Margin="0,0,10,0"/>
                                                    <TextBlock Text="Y:" Width="25" VerticalAlignment="Center"/>
                                                    <TextBox Text="{Binding OffsetY, UpdateSourceTrigger=PropertyChanged}" Width="55"/>
                                                </StackPanel>
                                                
                                                <!-- Box Size -->
                                                <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                                                    <TextBlock Text="W:" Width="25" VerticalAlignment="Center"/>
                                                    <TextBox Text="{Binding BoxWidth, UpdateSourceTrigger=PropertyChanged}" Width="55" Margin="0,0,10,0"/>
                                                    <TextBlock Text="H:" Width="25" VerticalAlignment="Center"/>
                                                    <TextBox Text="{Binding BoxHeight, UpdateSourceTrigger=PropertyChanged}" Width="55"/>
                                                </StackPanel>
                                                
                                                <!-- Font Settings -->
                                                <TextBlock Text="Font:" FontWeight="SemiBold" Margin="0,4,0,4" FontSize="11"/>
                                                <ComboBox SelectedValue="{Binding FontFamily, UpdateSourceTrigger=PropertyChanged}" 
                                                          SelectedValuePath="Content" Width="150" Margin="0,0,0,4" HorizontalAlignment="Left">
                                                    <ComboBoxItem Content="Arial"/>
                                                    <ComboBoxItem Content="Tahoma"/>
                                                    <ComboBoxItem Content="Times New Roman"/>
                                                    <ComboBoxItem Content="TH Sarabun New"/>
                                                    <ComboBoxItem Content="Angsana New"/>
                                                    <ComboBoxItem Content="Cordia New"/>
                                                    <ComboBoxItem Content="Leelawadee UI"/>
                                                </ComboBox>
                                                <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                                                    <TextBlock Text="Size:" Width="35" VerticalAlignment="Center"/>
                                                    <TextBox Text="{Binding FontSize, UpdateSourceTrigger=PropertyChanged}" Width="40" Margin="0,0,10,0"/>
                                                    <CheckBox Content="B" IsChecked="{Binding IsBold}" FontWeight="Bold" VerticalAlignment="Center" Margin="0,0,6,0" ToolTip="Bold"/>
                                                    <CheckBox Content="I" IsChecked="{Binding IsItalic}" FontStyle="Italic" VerticalAlignment="Center" ToolTip="Italic"/>
                                                </StackPanel>
                                                <CheckBox Content="Show Border" IsChecked="{Binding ShowBorder}" Margin="0,2,0,0"/>
                                                
                                                <!-- Rotation -->
                                                <StackPanel Orientation="Horizontal" Margin="0,6,0,4">
                                                    <TextBlock Text="Rotation:" Width="55" VerticalAlignment="Center"/>
                                                    <TextBox Text="{Binding Rotation, UpdateSourceTrigger=PropertyChanged}" Width="45" Margin="0,0,4,0"/>
                                                    <TextBlock Text="Â°" VerticalAlignment="Center"/>
                                                </StackPanel>
                                                
                                                <!-- Page Scope -->
                                                <TextBlock Text="Show on:" FontWeight="SemiBold" Margin="0,4,0,4" FontSize="11"/>
                                                <ComboBox SelectedValue="{Binding PageScope, UpdateSourceTrigger=PropertyChanged}" 
                                                          SelectedValuePath="Tag" Width="130" HorizontalAlignment="Left">
                                                    <ComboBoxItem Content="All Pages" Tag="{x:Static models:PageScope.AllPages}"/>
                                                    <ComboBoxItem Content="First Page Only" Tag="{x:Static models:PageScope.FirstPageOnly}"/>
                                                    <ComboBoxItem Content="Last Page Only" Tag="{x:Static models:PageScope.LastPageOnly}"/>
                                                    <ComboBoxItem Content="Odd Pages" Tag="{x:Static models:PageScope.OddPagesOnly}"/>
                                                    <ComboBoxItem Content="Even Pages" Tag="{x:Static models:PageScope.EvenPagesOnly}"/>
                                                    <ComboBoxItem Content="Custom Range" Tag="{x:Static models:PageScope.CustomRange}"/>
                                                </ComboBox>
                                                <!-- Custom Page Range (visible when CustomRange selected) -->
                                                <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                                    <StackPanel.Style>
                                                        <Style TargetType="StackPanel">
                                                            <Setter Property="Visibility" Value="Collapsed"/>
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding PageScope}" Value="{x:Static models:PageScope.CustomRange}">
                                                                    <Setter Property="Visibility" Value="Visible"/>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </StackPanel.Style>
                                                    <TextBlock Text="From:" Width="35" VerticalAlignment="Center"/>
                                                    <TextBox Text="{Binding StartPage, UpdateSourceTrigger=PropertyChanged}" Width="40" Margin="0,0,8,0"/>
                                                    <TextBlock Text="To:" Width="25" VerticalAlignment="Center"/>
                                                    <TextBox Text="{Binding EndPage, UpdateSourceTrigger=PropertyChanged}" Width="40"/>
                                                </StackPanel>
                                            </StackPanel>
                                            
                                            <!-- Center: Multiline Text -->
                                            <StackPanel Grid.Column="1">
                                                <TextBlock Text="Text (multiline):" FontWeight="SemiBold" Margin="0,0,0,4" FontSize="11"/>
                                                <TextBox Text="{Binding Text, UpdateSourceTrigger=PropertyChanged}" 
                                                         AcceptsReturn="True" TextWrapping="Wrap"
                                                         Height="120" VerticalScrollBarVisibility="Auto"
                                                         FontFamily="{Binding FontFamily}"
                                                         FontSize="11"/>
                                                <TextBlock Text="Placeholders: {page}, {total}, {date}, {filename}" 
                                                           Foreground="#888" FontSize="10" Margin="0,4,0,0"/>
                                            </StackPanel>
                                            
                                            <!-- Right: Actions -->
                                            <StackPanel Grid.Column="2" VerticalAlignment="Top" Margin="12,0,0,0">
                                                <Button Content="âœ•" 
                                                        Click="RemoveTextBox_Click" Tag="{Binding}"
                                                        Width="30" Height="30" Margin="0,0,0,4"
                                                        Background="#FF5252" Foreground="White" FontWeight="Bold"
                                                        ToolTip="Delete"/>
                                                <Button Content="ðŸ–¼ï¸" 
                                                        Click="ConvertToImageBox_Click" Tag="{Binding}"
                                                        Width="30" Height="30"
                                                        Background="#9C27B0" Foreground="White" FontWeight="Bold"
                                                        ToolTip="Convert to Image Box"/>
                                            </StackPanel>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>
                </Border>
                
                <!-- Custom Image Boxes Section -->
                <Border Background="White" CornerRadius="8" Padding="16" Margin="0,16,0,0">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                            <TextBlock Text="Custom Image Boxes" Style="{StaticResource SectionHeader}" VerticalAlignment="Center" Margin="0,0,16,0"/>
                            <Button x:Name="AddImageBoxBtn" Content="+ Add Image" Click="AddImageBox_Click" 
                                    Padding="12,4" Background="#2196F3" Foreground="White" FontWeight="SemiBold"/>
                        </StackPanel>
                        <TextBlock Text="Add logos, watermarks, stamps, or any image at specific positions on pages." 
                                   Foreground="#666666" FontSize="11" Margin="0,0,0,12" TextWrapping="Wrap"/>
                        
                        <!-- Custom Image Boxes List -->
                        <ItemsControl x:Name="CustomImageBoxesList">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="#F0F8FF" CornerRadius="4" Padding="12" Margin="0,0,0,12">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            
                                            <!-- Left: Settings -->
                                            <StackPanel Grid.Column="0" Margin="0,0,16,0" Width="220">
                                                <!-- Label -->
                                                <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                                                    <TextBlock Text="Label:" Width="55" VerticalAlignment="Center"/>
                                                    <TextBox Text="{Binding Label, UpdateSourceTrigger=PropertyChanged}" Width="150"/>
                                                </StackPanel>
                                                
                                                <!-- Position -->
                                                <TextBlock Text="Position (points):" FontWeight="SemiBold" Margin="0,4,0,4" FontSize="11"/>
                                                <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                                                    <TextBlock Text="X:" Width="25" VerticalAlignment="Center"/>
                                                    <TextBox Text="{Binding OffsetX, UpdateSourceTrigger=PropertyChanged}" Width="55" Margin="0,0,10,0"/>
                                                    <TextBlock Text="Y:" Width="25" VerticalAlignment="Center"/>
                                                    <TextBox Text="{Binding OffsetY, UpdateSourceTrigger=PropertyChanged}" Width="55"/>
                                                </StackPanel>
                                                
                                                <!-- Image Size -->
                                                <TextBlock Text="Size (points):" FontWeight="SemiBold" Margin="0,4,0,4" FontSize="11"/>
                                                <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                                                    <TextBlock Text="W:" Width="25" VerticalAlignment="Center"/>
                                                    <TextBox Text="{Binding Width, UpdateSourceTrigger=PropertyChanged}" Width="55" Margin="0,0,10,0"/>
                                                    <TextBlock Text="H:" Width="25" VerticalAlignment="Center"/>
                                                    <TextBox Text="{Binding Height, UpdateSourceTrigger=PropertyChanged}" Width="55"/>
                                                </StackPanel>
                                                
                                                <!-- Rotation -->
                                                <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                                                    <TextBlock Text="Rotation:" Width="55" VerticalAlignment="Center"/>
                                                    <TextBox Text="{Binding Rotation, UpdateSourceTrigger=PropertyChanged}" Width="45" Margin="0,0,4,0"/>
                                                    <TextBlock Text="Â°" VerticalAlignment="Center"/>
                                                </StackPanel>
                                                
                                                <!-- Opacity -->
                                                <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                                                    <TextBlock Text="Opacity:" Width="55" VerticalAlignment="Center"/>
                                                    <Slider Value="{Binding Opacity, UpdateSourceTrigger=PropertyChanged}" 
                                                            Minimum="0.1" Maximum="1.0" Width="80" VerticalAlignment="Center"/>
                                                    <TextBlock Text="{Binding Opacity, StringFormat={}{0:P0}}" Width="40" Margin="4,0,0,0" VerticalAlignment="Center"/>
                                                </StackPanel>
                                                
                                                <!-- Page Scope -->
                                                <TextBlock Text="Show on:" FontWeight="SemiBold" Margin="0,4,0,4" FontSize="11"/>
                                                <ComboBox SelectedValue="{Binding PageScope, UpdateSourceTrigger=PropertyChanged}" 
                                                          SelectedValuePath="Tag" Width="130" HorizontalAlignment="Left">
                                                    <ComboBoxItem Content="All Pages" Tag="{x:Static models:PageScope.AllPages}"/>
                                                    <ComboBoxItem Content="First Page Only" Tag="{x:Static models:PageScope.FirstPageOnly}"/>
                                                    <ComboBoxItem Content="Last Page Only" Tag="{x:Static models:PageScope.LastPageOnly}"/>
                                                    <ComboBoxItem Content="Odd Pages" Tag="{x:Static models:PageScope.OddPagesOnly}"/>
                                                    <ComboBoxItem Content="Even Pages" Tag="{x:Static models:PageScope.EvenPagesOnly}"/>
                                                    <ComboBoxItem Content="Custom Range" Tag="{x:Static models:PageScope.CustomRange}"/>
                                                </ComboBox>
                                                <!-- Custom Page Range (visible when CustomRange selected) -->
                                                <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                                    <StackPanel.Style>
                                                        <Style TargetType="StackPanel">
                                                            <Setter Property="Visibility" Value="Collapsed"/>
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding PageScope}" Value="{x:Static models:PageScope.CustomRange}">
                                                                    <Setter Property="Visibility" Value="Visible"/>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </StackPanel.Style>
                                                    <TextBlock Text="From:" Width="35" VerticalAlignment="Center"/>
                                                    <TextBox Text="{Binding StartPage, UpdateSourceTrigger=PropertyChanged}" Width="40" Margin="0,0,8,0"/>
                                                    <TextBlock Text="To:" Width="25" VerticalAlignment="Center"/>
                                                    <TextBox Text="{Binding EndPage, UpdateSourceTrigger=PropertyChanged}" Width="40"/>
                                                </StackPanel>
                                            </StackPanel>
                                            
                                            <!-- Center: Image Preview & Path -->
                                            <StackPanel Grid.Column="1">
                                                <TextBlock Text="Image:" FontWeight="SemiBold" Margin="0,0,0,4" FontSize="11"/>
                                                <Button Content="Select Image..." Click="SelectCustomImage_Click" Tag="{Binding}"
                                                        Padding="8,4" HorizontalAlignment="Left" Margin="0,0,0,8"/>
                                                <TextBlock Text="{Binding ImagePath}" FontSize="10" TextTrimming="CharacterEllipsis" 
                                                           Foreground="#666" Margin="0,0,0,8" ToolTip="{Binding ImagePath}"/>
                                                <!-- Image Preview -->
                                                <Border BorderBrush="#DDD" BorderThickness="1" MaxWidth="200" MaxHeight="100" HorizontalAlignment="Left">
                                                    <Image Source="{Binding ImagePath}" Stretch="Uniform" 
                                                           RenderOptions.BitmapScalingMode="HighQuality"/>
                                                </Border>
                                            </StackPanel>
                                            
                                            <!-- Right: Actions -->
                                            <StackPanel Grid.Column="2" VerticalAlignment="Top" Margin="12,0,0,0">
                                                <Button Content="âœ•" 
                                                        Click="RemoveImageBox_Click" Tag="{Binding}"
                                                        Width="30" Height="30" Margin="0,0,0,4"
                                                        Background="#FF5252" Foreground="White" FontWeight="Bold"
                                                        ToolTip="Delete"/>
                                                <Button Content="ðŸ“" 
                                                        Click="ConvertToTextBox_Click" Tag="{Binding}"
                                                        Width="30" Height="30"
                                                        Background="#FF9800" Foreground="White" FontWeight="Bold"
                                                        ToolTip="Convert to Text Box"/>
                                            </StackPanel>
                                        </Grid>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>
        
        <!-- Buttons -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,16,0,0">
            <Button x:Name="CancelButton" Content="Cancel" Width="100" Padding="16,8" Click="Cancel_Click" Margin="0,0,8,0"/>
            <Button x:Name="ApplyButton" Content="Apply" Width="100" Padding="16,8" Click="Apply_Click"
                    Background="#2196F3" Foreground="White" FontWeight="SemiBold"/>
        </StackPanel>
    </Grid>
</Window>
